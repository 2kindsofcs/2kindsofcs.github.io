---
layout: post
title: "2019-05-17-TIL"
slug: "190517-TIL"
tags: [TIL]
---
## 슬랙 사다리 챗봇 만들기
내가 일주일에 한 번은 반드시 슬랙 채팅방에 있는 사람들과 함께 사다리를 탄다는 사실을 깨닫고, 사다리를 타주는 슬랙 봇을 만들고자 했다. 

목표는 단순하다. 내가 "사다리 1 / 2 / 3" 처럼 메세지를 입력하면, 슬랙 봇이 채팅방에 있는 사람들 목록과 매칭시켜서 결과를 답해주는 것이다. "A: 3, B: 1, C: 2"하는 식으로 말이다. 
처음에는 rtm으로 간단하게 해결할 수 있을 거라고 생각했다. 일단 유저의 메세지에 반응하게끔 코드를 간단하게 짜서 헤로쿠에서 배포하였다. 하지만 배포한 직후에만 작동을 하고, 잠시라도 메세지를 보내지 않으면 sleep mode가 되었는지 메세지를 보내도 아무런 반응이 없었다. 다른 사람들의 블로그를 많이 찾아보았는데, 다들 rtm을 멀쩡히 쓰는 것 같았는데 무엇이 문제인지 이해하기 힘들었다. 그러다 챗봇을 만들어본 적 있는 동아리 선배분이 해답을 알려주셨다. 헤로쿠의 free plan은 web dyno라는 가상머신을 제공하는데, 일정 시간동안 http 요청이 오지 않으면 sleep mode가 된다. sleep mode인 상태에서 http 요청을 받으면 잠에서 깨어나는 데 시간이 조금 걸리며, 깨어난 이후 정상적으로 응답을 하게 된다. (그래서 헤로쿠가 왜 응답 속도가 늦냐는 질문글을 많이 볼 수 있기도 하다.) rtm의 경우 
구글 클라우드 플랫폼이나 개인용 서버에 올리면 문제가 없었을 것이다. 

(보강 필요)

## 간단한 명령어 문법 
명령어 순서인자 / 옵션 인자
pm2 start index.js 
pm2가 start 한다 index.js를  

옵션인자 --name zombie-server -> 옵션으로 좀비서버라는 이름을 쓰겠다는 것 



